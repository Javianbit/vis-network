<html>
  <head>
    <meta charset="utf-8" />
    <title>Vis Network | Other | Clustering by Zoom Level</title>
  </head>
  <body>
    <form
      id="form"
      action="https://codepen.io/pen/define"
      method="post"
      target="_self"
    >
      <input
        type="hidden"
        name="data"
        value='{"css":"#mynetwork {\n  width: 600px;\n  height: 600px;\n  border: 1px solid lightgray;\n}\n\np {\n  max-width: 600px;\n}\n\nh4 {\n  margin-bottom: 3px;\n}\n","css_external":"","html":"<p>You can zoom in and out to cluster/decluster.</p>\nStabilize when clustering:<input type=\"checkbox\" id=\"stabilizeCheckbox\" />\n<div id=\"mynetwork\"></div>\n","js":"var clusterIndex = 0;\nvar clusters = [];\nvar lastClusterZoomLevel = 0;\nvar clusterFactor = 0.9;\n\n// create an array with nodes\nvar nodes = [\n  { id: 1, label: \"Node 1\" },\n  { id: 2, label: \"Node 2\" },\n  { id: 3, label: \"Node 3\" },\n  { id: 4, label: \"Node 4\" },\n  { id: 5, label: \"Node 5\" },\n  { id: 6, label: \"Node 6\" },\n  { id: 7, label: \"Node 7\" },\n  { id: 8, label: \"Node 8\" },\n  { id: 9, label: \"Node 9\" },\n  { id: 10, label: \"Node 10\" },\n];\n\n// create an array with edges\nvar edges = [\n  { from: 1, to: 2 },\n  { from: 1, to: 3 },\n  { from: 10, to: 4 },\n  { from: 2, to: 5 },\n  { from: 6, to: 2 },\n  { from: 7, to: 5 },\n  { from: 8, to: 6 },\n  { from: 9, to: 7 },\n  { from: 10, to: 9 },\n];\n\n// create a network\nvar container = document.getElementById(\"mynetwork\");\nvar data = {\n  nodes: nodes,\n  edges: edges,\n};\nvar options = {\n  layout: { randomSeed: 8 },\n  physics: { adaptiveTimestep: false },\n};\nvar network = new vis.Network(container, data, options);\n\n// set the first initial zoom level\nnetwork.once(\"initRedraw\", function () {\n  if (lastClusterZoomLevel === 0) {\n    lastClusterZoomLevel = network.getScale();\n  }\n});\n\n// we use the zoom event for our clustering\nnetwork.on(\"zoom\", function (params) {\n  if (params.direction == \"-\") {\n    if (params.scale < lastClusterZoomLevel * clusterFactor) {\n      makeClusters(params.scale);\n      lastClusterZoomLevel = params.scale;\n    }\n  } else {\n    openClusters(params.scale);\n  }\n});\n\n// if we click on a node, we want to open it up!\nnetwork.on(\"selectNode\", function (params) {\n  if (params.nodes.length == 1) {\n    if (network.isCluster(params.nodes[0]) == true) {\n      network.openCluster(params.nodes[0]);\n    }\n  }\n});\n\n// make the clusters\nfunction makeClusters(scale) {\n  var clusterOptionsByData = {\n    processProperties: function (clusterOptions, childNodes) {\n      clusterIndex = clusterIndex + 1;\n      var childrenCount = 0;\n      for (var i = 0; i < childNodes.length; i++) {\n        childrenCount += childNodes[i].childrenCount || 1;\n      }\n      clusterOptions.childrenCount = childrenCount;\n      clusterOptions.label = \"# \" + childrenCount + \"\";\n      clusterOptions.font = { size: childrenCount * 5 + 30 };\n      clusterOptions.id = \"cluster:\" + clusterIndex;\n      clusters.push({ id: \"cluster:\" + clusterIndex, scale: scale });\n      return clusterOptions;\n    },\n    clusterNodeProperties: {\n      borderWidth: 3,\n      shape: \"database\",\n      font: { size: 30 },\n    },\n  };\n  network.clusterOutliers(clusterOptionsByData);\n  if (document.getElementById(\"stabilizeCheckbox\").checked === true) {\n    // since we use the scale as a unique identifier, we do NOT want to fit after the stabilization\n    network.setOptions({ physics: { stabilization: { fit: false } } });\n    network.stabilize();\n  }\n}\n\n// open them back up!\nfunction openClusters(scale) {\n  var newClusters = [];\n  var declustered = false;\n  for (var i = 0; i < clusters.length; i++) {\n    if (clusters[i].scale < scale) {\n      network.openCluster(clusters[i].id);\n      lastClusterZoomLevel = scale;\n      declustered = true;\n    } else {\n      newClusters.push(clusters[i]);\n    }\n  }\n  clusters = newClusters;\n  if (\n    declustered === true &amp;&amp;\n    document.getElementById(\"stabilizeCheckbox\").checked === true\n  ) {\n    // since we use the scale as a unique identifier, we do NOT want to fit after the stabilization\n    network.setOptions({ physics: { stabilization: { fit: false } } });\n    network.stabilize();\n  }\n}\n","js_external":"https://visjs.github.io/vis-network/standalone/umd/vis-network.min.js","title":"Vis Network | Other | Clustering by Zoom Level"}'
      />
      <button id="open" alt="JSFiddle" title="JSFiddle">Open CodePen</button>
    </form>

    <script type="text/javascript">
      document.getElementById("open").click();
    </script>
  </body>
</html>
